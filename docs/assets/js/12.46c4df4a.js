(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{185:function(t,s,n){"use strict";n.r(s);var a=n(0),e=Object(a.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"content"},[n("h1",{attrs:{id:"preload-js"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#preload-js","aria-hidden":"true"}},[t._v("#")]),t._v(" preload.js")]),t._v(" "),n("p",[t._v("当你在"),n("code",[t._v("plugin.json")]),t._v("中配置了"),n("code",[t._v("preload")]),t._v("属性，将载入对应的预加载脚本。")]),t._v(" "),n("p",[t._v("在传统的web开发中，所有的javascript脚本都在浏览器沙盒中运行，权限被严格限制，所能实现的功能非常有限。")]),t._v(" "),n("p",[t._v("通过"),n("code",[t._v("preload.js")]),t._v("能够帮你突破沙盒限制，进入一个崭新的JavaScript世界。")]),t._v(" "),n("p",[n("code",[t._v("preload.js")]),t._v(" 是一个特殊且单独的文件，不需要与其他业务代码编译在一起，在此文件中可以访问"),n("code",[t._v("nodejs")]),t._v("、"),n("code",[t._v("electron")]),t._v("、"),n("code",[t._v("uTools")]),t._v("提供的api，并挂载到"),n("code",[t._v("window")]),t._v("对象中，你其他的普通javascript代码就可以访问这些 api。")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 开发者可以暴露自定义API供后加载脚本使用")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// preload.js 中使用nodejs")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" readFileSync "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nwindow"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("readConfig")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" data "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFileSync")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./config.json'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" data\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\t\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// index.html 后加载的内容可以使用window.readConfig()方法，但不能使用Node.js特性")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("readConfig")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 正常执行")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFileSync")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./config.json'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 报错")]),t._v("\n\n")])])]),n("p",[t._v("通过这种机制可以获得强大的底层能力，配合html、css丰富的表现力，你完全可以按你理想中的样子去设计程序。")]),t._v(" "),n("p",[t._v("但是，更强大的能力如果不受约束就会伴随着更大风险，在使用预加载脚本时，应该时刻注意只提供必要且最小权限的api供后加载脚本使用。")]),t._v(" "),n("p",[t._v("（如果你想把插件提交到utools插件中心供其他用户下载使用，"),n("code",[t._v("preload.js")]),t._v("必须是明文代码，且精简清晰可读。）")])])}],!1,null,null,null);e.options.__file="preload.md";s.default=e.exports}}]);